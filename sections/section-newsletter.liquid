<!-- /sections/newsletter.liquid -->
{%- if section.blocks.size > 0 -%}
  {%- liquid
    assign block_count = section.blocks.size
    assign animation_anchor = '#Newsletter--' | append: section.id
    assign color_scheme = 'color-' | append: section.settings.color_scheme
  -%}

  {%- style -%}
    /* Section Background */
    #Newsletter--{{ section.id }} {
      {% if section.settings.bg_image != blank %}
        background: url({{ section.settings.bg_image | img_url: '2000x' }}) no-repeat center center;
        background-size: cover;
      {% endif %}
      min-height: 450px !important;
      height: auto;
      padding: 60px 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Brick section ko center align karna */
    #Newsletter--{{ section.id }} .brick__section {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Badge wrapper */
    .newsletter-badge-wrapper {
      position: relative;
      width: 100%;
      max-width: 600px; /* limit width */
    }
    .newsletter-badge {
      position: absolute;
      left: 50%;
      top: 0;
      transform: translate(-50%, -50%);
      z-index: 5;
    }
    .newsletter-badge img {
      border-radius: 50%;
      display: block;
    }

    /* Form Box */
    .newsletter-form-wrapper {
      background: #F4F3EC;
      border-radius: 12px;
      padding: 3rem 2rem;
      text-align: center;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      position: relative;
    }

    /* Heading + text */
    .newsletter-form-wrapper h2 {
      margin-bottom: 0.5rem;
    }
    .newsletter-form-wrapper .newsletter-text {
      margin-bottom: 2rem;
    }

    /* Input underline only */
    .newsletter-form-wrapper form input {
      width: 100%;
      padding: 10px 5px;
      margin-bottom: 1.5rem;
      border: none;
      border-bottom: 2px solid #aaa;
      font-size: 16px;
      outline: none;
      background: transparent;
      text-align: left;
      border-radius: 0;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }
    .newsletter-form-wrapper form input:focus {
      border-bottom: 2px solid #333;
    }

    /* Button */
    .newsletter-form-wrapper form button {
      width: 100%;
      max-width: 440px;
      height: 45.25px;
      border-radius: 300px;
      display: inline-block;
      background-color: #E0E07E; /* fixed bg color */
      border: none;
      color: #000; /* black text for good contrast */
      transition: all 0.3s ease;
    }
    .newsletter-form-wrapper form button:hover {
      background-color: #d0d06e; /* slightly darker on hover */
    }
    
    /* Responsive Styles */
    @media screen and (max-width: 768px) {
      #Newsletter--{{ section.id }} {
        min-height: 350px;
        padding: 40px 15px;
      }
      
      .newsletter-form-wrapper {
        padding: 2rem 1.5rem;
      }
      
      .newsletter-form-wrapper h2 {
        font-size: 24px !important;
      }
      
      .newsletter-form-wrapper .newsletter-text {
        font-size: 14px !important;
      }
      
      .newsletter-form-wrapper form input {
        font-size: 14px;
      }
      
      .newsletter-form-wrapper form button {
        height: 40px;
        font-size: 14px;
      }
    }
    
    @media screen and (max-width: 480px) {
      #Newsletter--{{ section.id }} {
        min-height: 300px;
        padding: 30px 15px;
      }
      
      .newsletter-form-wrapper {
        padding: 1.5rem 1rem;
      }
      
      .newsletter-form-wrapper h2 {
        font-size: 20px !important;
      }
      
      .newsletter-form-wrapper .newsletter-text {
        font-size: 13px !important;
      }
      
      .newsletter-form-wrapper form button {
        height: 38px;
        font-size: 13px;
      }
    }
  {%- endstyle -%}

  <div
    id="Newsletter--{{ section.id }}"
    class="index-newsletter {{ color_scheme }}"
    data-section-id="{{ section.id }}"
    data-section-type="newsletter"
  >
    {%- if block_count > 0 -%}
      <div class="brick__section">
        <div class="newsletter-badge-wrapper">
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when 'newsletter' -%}

                {%- if block.settings.badge_image != blank -%}
                  <div class="newsletter-badge">
                    <img 
                      src="{{ block.settings.badge_image | img_url: '200x' }}" 
                      alt="Badge"
                      style="width: {{ block.settings.badge_size }}px; height: {{ block.settings.badge_size }}px;"
                    >
                  </div>
                {%- endif -%}

                <div class="newsletter-form-wrapper">
                  {%- if block.settings.heading != blank -%}
                    <h2 style="font-size: {{ block.settings.heading_size }}px;">
                      {{ block.settings.heading }}
                    </h2>
                  {%- endif -%}

                  {%- if block.settings.text != blank -%}
                    <div class="newsletter-text" style="font-size: {{ block.settings.text_size }}px;">
                      {{ block.settings.text }}
                    </div>
                  {%- endif -%}

                  <form method="post" action="/contact#Newsletter--{{ section.id }}">
                    {%- if block.settings.show_name -%}
                      <input type="text" name="contact[name]" placeholder="Name">
                    {%- endif -%}
                    <input type="email" name="contact[email]" placeholder="Email" required>
                    <button type="submit" class="btn {{ block.settings.button_type }}">
                      {{ block.settings.button_text }}
                      {%- if block.settings.show_arrow -%}
                        <span class="icon-arrow">‚ûù</span>
                      {%- endif -%}
                    </button>
                  </form>
                </div>

            {%- endcase -%}
          {%- endfor -%}
        </div>
      </div>
    {%- endif -%}
  </div>
{%- endif -%}

{% schema %}
{
  "name": "Newsletter",
  "settings": [
    {
      "type": "image_picker",
      "id": "bg_image",
      "label": "Background Image",
      "info": "Background image of the section"
    }
  ],
  "blocks": [
    {
      "type": "newsletter",
      "name": "Newsletter Form",
      "settings": [
        {
          "type": "image_picker",
          "id": "badge_image",
          "label": "Badge Image"
        },
        {
          "type": "text",
          "id": "badge_size",
          "label": "Badge size (px)",
          "default": "80"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "The key to the casa is yours"
        },
        {
          "type": "text",
          "id": "heading_size",
          "label": "Heading size (px)",
          "default": "28"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Description",
          "default": "<p>Sign up to receive news, promos, and inspiration via email.</p>"
        },
        {
          "type": "text",
          "id": "text_size",
          "label": "Text size (px)",
          "default": "16"
        },
        {
          "type": "checkbox",
          "id": "show_name",
          "label": "Show name field",
          "default": true
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button text",
          "default": "GET THE KEY"
        },
        {
          "type": "select",
          "id": "button_type",
          "label": "Button color",
          "default": "btn--primary",
          "options": [
            {"value": "btn--primary", "label": "Primary"},
            {"value": "btn--secondary", "label": "Secondary"},
            {"value": "btn--black", "label": "Black"},
            {"value": "btn--white", "label": "White"}
          ]
        },
        {
          "type": "checkbox",
          "id": "show_arrow",
          "label": "Show arrow",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Newsletter",
      "blocks": [
        {"type": "newsletter"}
      ]
    }
  ]
}
{% endschema %}